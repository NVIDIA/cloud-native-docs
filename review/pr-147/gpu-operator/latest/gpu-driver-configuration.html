<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NVIDIA GPU Driver Custom Resource Definition &mdash; NVIDIA GPU Operator 24.9.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" type="text/css" />
      <link rel="stylesheet" href="_static/omni-style.css" type="text/css" />
      <link rel="stylesheet" href="_static/api-styles.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/mermaid-init.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/design-tabs.js"></script>
        <script src="_static/version.js"></script>
        <script src="_static/social-media.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Container Device Interface Support in the GPU Operator" href="cdi.html" />
    <link rel="prev" title="Precompiled Driver Containers" href="precompiled-drivers.html" />
 
<script src="https://assets.adobedtm.com/5d4962a43b79/c1061d2c5e7b/launch-191c2462b890.min.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/nvidia-logo-white.png" class="logo" alt="Logo"/>
          </a>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">NVIDIA GPU Operator</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">About the Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade.html">Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="uninstall.html">Uninstall</a></li>
<li class="toctree-l1"><a class="reference internal" href="platform-support.html">Platform Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-driver-upgrades.html">GPU Driver Upgrades</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-operator-vgpu.html">Using NVIDIA vGPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-operator-nvaie.html">NVIDIA AI Enterprise</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Operator Configuration</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gpu-operator-mig.html">Multi-Instance GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-sharing.html">Time-Slicing GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-operator-rdma.html">GPUDirect RDMA and GPUDirect Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-operator-outdated-kernels.html">Outdated Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom-driver-params.html">Custom GPU Driver Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="precompiled-drivers.html">Precompiled Driver Containers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">GPU Driver CRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="cdi.html">Container Device Interface Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sandboxed Workloads</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gpu-operator-kubevirt.html">KubeVirt</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-operator-kata.html">Kata Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-operator-confidential-containers.html">Confidential Containers and Kata</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Specialized Networks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-operator-proxy.html">HTTP Proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-operator-air-gapped.html">Air-Gapped Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-operator-service-mesh.html">Service Mesh</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CSP configurations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="amazon-eks.html">Amazon EKS</a></li>
<li class="toctree-l1"><a class="reference internal" href="microsoft-aks.html">Azure AKS</a></li>
<li class="toctree-l1"><a class="reference internal" href="google-gke.html">Google GKE</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NVIDIA GPU Operator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
<div> <!-- class="omni-version-warning" -->
  <p class="omni-version-warning-content"> Upgrade to NVIDIA Container Toolkit v1.16.2 or higher, or GPU Operator v24.6.2 or higher to install a critical security update.<br/>
  Refer to <a href="https://nvidia.custhelp.com/app/answers/detail/a_id/5582">Security Bulletin: NVIDIA Container Toolkit - September 2024</a> for more information.</p>
</div>

<li>
    <a href="https://docs.nvidia.com">NVIDIA Docs Hub</a>
    <i class="fa fa-chevron-right" aria-hidden="true"></i>
</li>
<li>
    <a href="https://docs.nvidia.com/datacenter/cloud-native/">NVIDIA Cloud Native Technologies</a>
    <i class="fa fa-chevron-right" aria-hidden="true"></i>
</li>
<li>NVIDIA GPU Driver Custom Resource Definition</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nvidia-gpu-driver-custom-resource-definition">
<h1>NVIDIA GPU Driver Custom Resource Definition<a class="headerlink" href="#nvidia-gpu-driver-custom-resource-definition" title="Permalink to this headline"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview-of-the-gpu-driver-custom-resource-definition" id="id2">Overview of the GPU Driver Custom Resource Definition</a></p>
<ul>
<li><p><a class="reference internal" href="#comparison-managing-the-driver-with-crd-versus-the-cluster-policy" id="id3">Comparison: Managing the Driver with CRD versus the Cluster Policy</a></p></li>
<li><p><a class="reference internal" href="#driver-daemon-sets" id="id4">Driver Daemon Sets</a></p></li>
<li><p><a class="reference internal" href="#about-the-default-nvidia-driver-custom-resource" id="id5">About the Default NVIDIA Driver Custom Resource</a></p></li>
<li><p><a class="reference internal" href="#feature-compatibility" id="id6">Feature Compatibility</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#about-the-nvidia-driver-custom-resource" id="id7">About the NVIDIA Driver Custom Resource</a></p></li>
<li><p><a class="reference internal" href="#installing-the-nvidia-gpu-operator" id="id8">Installing the NVIDIA GPU Operator</a></p></li>
<li><p><a class="reference internal" href="#sample-nvidia-driver-manifests" id="id9">Sample NVIDIA Driver Manifests</a></p>
<ul>
<li><p><a class="reference internal" href="#one-driver-type-and-version-on-all-nodes" id="id10">One Driver Type and Version on All Nodes</a></p></li>
<li><p><a class="reference internal" href="#multiple-driver-versions" id="id11">Multiple Driver Versions</a></p></li>
<li><p><a class="reference internal" href="#one-precompiled-driver-container-on-all-nodes" id="id12">One Precompiled Driver Container on All Nodes</a></p></li>
<li><p><a class="reference internal" href="#precompiled-driver-container-on-some-nodes" id="id13">Precompiled Driver Container on Some Nodes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#upgrading-the-nvidia-gpu-driver" id="id14">Upgrading the NVIDIA GPU Driver</a></p></li>
<li><p><a class="reference internal" href="#troubleshooting" id="id15">Troubleshooting</a></p></li>
</ul>
</div>
<section id="overview-of-the-gpu-driver-custom-resource-definition">
<h2>Overview of the GPU Driver Custom Resource Definition<a class="headerlink" href="#overview-of-the-gpu-driver-custom-resource-definition" title="Permalink to this headline"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Technology Preview features are not supported in production environments
and are not functionally complete.
Technology Preview features provide early access to upcoming product features,
enabling customers to test functionality and provide feedback during the development process.
These releases may not have any documentation, and testing is limited.</p>
<p>This feature does not support an upgrade from an earlier version of the NVIDIA GPU Operator.
You must uninstall an existing installation and then install the Operator again.
Uninstalling the Operator interrupts services and applications that require access to NVIDIA GPUs.</p>
</div>
<p>As a technology preview feature, you can create one or more instances of an NVIDIA driver custom resource
to specify the NVIDIA GPU driver type and driver version to configure on specific nodes.
You can specify labels in the node selector field to control which NVIDIA driver configuration is applied to specific nodes.</p>
<section id="comparison-managing-the-driver-with-crd-versus-the-cluster-policy">
<h3>Comparison: Managing the Driver with CRD versus the Cluster Policy<a class="headerlink" href="#comparison-managing-the-driver-with-crd-versus-the-cluster-policy" title="Permalink to this headline"></a></h3>
<p>Before the introduction of the NVIDIA GPU Driver custom resource definition, you manage the driver by modifying
the driver field and subfields of the cluster policy custom resource definition.</p>
<p>The key differences between the two approaches are summarized in the following table.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Cluster Policy CRD</p></th>
<th class="head"><p>NVIDIA Driver CRD</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><ul class="simple">
<li><p>Supports a single driver type and version on all nodes.</p></li>
<li><p>Does not support multiple operating system versions.
This limitation complicates performing an operating system upgrade on your nodes.</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Supports multiple driver types and versions on different nodes.</p></li>
<li><p>Supports multiple operating system versions on nodes.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="driver-daemon-sets">
<h3>Driver Daemon Sets<a class="headerlink" href="#driver-daemon-sets" title="Permalink to this headline"></a></h3>
<p>The NVIDIA GPU Operator starts a driver daemon set for each NVIDIA driver custom resource and each operating system version.</p>
<p>For example, if your cluster has one NVIDIA driver custom resource that specifies a 535 branch GPU driver and some
worker nodes run Ubuntu 20.04 and other worker nodes run Ubuntu 22.04, the Operator starts two driver daemon sets.
One daemon set configures the GPU driver on the Ubuntu 20.04 nodes and the other configures the driver on the Ubuntu 22.04 nodes.
All the nodes run the same 535 branch GPU driver.</p>
<img alt="_images/nvd-basics.svg" src="_images/nvd-basics.svg" /><p>If you choose to use precompiled driver containers, the Operator starts a driver daemon set for each Linux kernel version.</p>
<p>For example, if some nodes run Ubuntu 22.04 and the 5.15.0-84-generic kernel, and other nodes run the 5.15.0-78-generic kernel,
then the Operator starts two daemon sets.</p>
</section>
<section id="about-the-default-nvidia-driver-custom-resource">
<h3>About the Default NVIDIA Driver Custom Resource<a class="headerlink" href="#about-the-default-nvidia-driver-custom-resource" title="Permalink to this headline"></a></h3>
<p>By default, the helm chart configures a default NVIDIA driver custom resource during installation.
This custom resource does not include a node selector and as a result, the custom resource applies to every node in your cluster
that has an NVIDIA GPU.
The Operator starts a driver daemon set and pods for each operating system version in your cluster.</p>
<p>If you plan to configure your own driver custom resources to specify driver versions, types, and so on, then
you might prefer to avoid installing the default custom resource.
By preventing the installation, you can avoid node selector conflicts due to the default custom resource
matching all nodes and your custom resources matching some of the same nodes.</p>
<p>To prevent configuring the default custom resource, specify the <code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">driver.nvidiaDriverCRD.deployDefaultCR=false</span></code>
argument when you install the Operator with Helm.</p>
</section>
<section id="feature-compatibility">
<h3>Feature Compatibility<a class="headerlink" href="#feature-compatibility" title="Permalink to this headline"></a></h3>
<dl class="simple">
<dt>Driver type</dt><dd><p>Each NVIDIA driver custom resource specifies the driver type and is one of <code class="docutils literal notranslate"><span class="pre">gpu</span></code>, <code class="docutils literal notranslate"><span class="pre">vgpu</span></code>, or <code class="docutils literal notranslate"><span class="pre">vgpu-host-manager</span></code>.
You can run the data-center driver (<code class="docutils literal notranslate"><span class="pre">gpu</span></code>) on some nodes and the vGPU driver on other nodes.</p>
</dd>
<dt>GPUDirect RDMA and GPUDirect Storage</dt><dd><p>Each NVIDIA driver custom resource can specify how to configure GPUDirect RDMA and GPUDirect Storage (GDS).
Refer to <a class="reference internal" href="gpu-operator-rdma.html#gpudirect-rdma-and-gpudirect-storage"><span class="std std-ref">GPUDirect RDMA and GPUDirect Storage</span></a> for the platform support and prerequisites.</p>
</dd>
<dt>GDRCopy</dt><dd><p>Each NVIDIA driver custom resource can enable the GDRCopy sidecar container in the driver pod.</p>
</dd>
<dt>Precompiled and signed drivers</dt><dd><p>You can run the default driver type that is compiled when the driver pod starts on some nodes
and precompiled driver containers on other nodes.
The <a class="reference internal" href="precompiled-drivers.html#precomp-limitations-restrictions"><span class="std std-ref">Limitations and Restrictions</span></a> for precompiled driver containers apply.</p>
</dd>
<dt>Preinstalled drivers on nodes</dt><dd><p>If a node has an NVIDIA GPU driver installed in the operating system, then no driver container runs on the node.</p>
</dd>
<dt>Support for X86_64 and ARM64</dt><dd><p>Each daemon set can run pods and driver containers for the X86_64 and ARM64 architectures.
Refer to the <a class="reference external" href="https://catalog.ngc.nvidia.com/orgs/nvidia/containers/driver/tags">NVIDIA GPU Driver tags</a>
web page to determine which driver version and operating system combinations support both architectures.</p>
</dd>
</dl>
</section>
</section>
<section id="about-the-nvidia-driver-custom-resource">
<h2>About the NVIDIA Driver Custom Resource<a class="headerlink" href="#about-the-nvidia-driver-custom-resource" title="Permalink to this headline"></a></h2>
<p>An instance of the NVIDIA driver custom resource represents a specific NVIDIA GPU driver type and driver version to install and manage
on nodes.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Sample NVIDIA Driver Manifest</span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia.com/v1alpha1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NVIDIADriver</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo-gold</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">driverType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu</span><span class="w"></span>
<span class="w">  </span><span class="nt">gdrcopy</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">    </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia/cloud-native</span><span class="w"></span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gdrdrv</span><span class="w"></span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v2.4.1</span><span class="w"></span>
<span class="w">    </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class="w"></span>
<span class="w">    </span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">driver</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">manager</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">nodeSelector</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">driver.config</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gold&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">rdma</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">    </span><span class="nt">useHostMofed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">gds</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia</span><span class="w"></span>
<span class="w">  </span><span class="nt">startupProbe</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">failureThreshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">120</span><span class="w"></span>
<span class="w">    </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class="w"></span>
<span class="w">    </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w"></span>
<span class="w">    </span><span class="nt">timeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class="w"></span>
<span class="w">  </span><span class="nt">useOpenKernelModules</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">usePrecompiled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">535.104.12</span><span class="w"></span>
</pre></div>
</div>
</div>
<p>The following table describes some of the fields in the custom resource.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 60%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">metadata.name</span></code></p></td>
<td><p>Specifies the name of the NVIDIA driver custom resource.</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">annotations</span></code></p></td>
<td><p>Specifies a map of key and value pairs to add as custom annotations to the driver pod.</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">driverType</span></code></p></td>
<td><p>Specifies one of the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gpu</span></code> to use the NVIDIA data-center GPU driver.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vgpu</span></code> to use the NVIDIA vGPU guest driver.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vgpu-host-manager</span></code> to use the NVIDIA vGPU Manager.</p></li>
</ul>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">gpu</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">env</span></code></p></td>
<td><p>Specifies environment variables to pass to the driver container.</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gdrcopy.enabled</span></code></p></td>
<td><p>Specifies whether to deploy the GDRCopy Driver.
When set to <code class="docutils literal notranslate"><span class="pre">true</span></code> the GDRCopy Driver image runs as a sidecar container.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gds.enabled</span></code></p></td>
<td><p>Specifies whether to enable GPUDirect Storage.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">image</span></code></p></td>
<td><p>Specifies the driver container image name.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">driver</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">imagePullPolicy</span></code></p></td>
<td><p>Specifies the policy for kubelet to download the container image.
Refer to the Kubernetes documentation for
<a class="reference external" href="https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy">image pull policy</a>.</p></td>
<td><p>Refer to the Kubernetes documentation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">imagePullSecrets</span></code></p></td>
<td><p>Specifies the credentials to provide to the registry if the registry is secured.</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">labels</span></code></p></td>
<td><p>Specifies a map of key and value pairs to add as custom labels to the driver pod.</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nodeSelector</span></code></p></td>
<td><p>Specifies one or more node labels to match.
The driver container is scheduled to nodes that match all the labels.</p></td>
<td><p>None.
When you do not specify this field, the driver custom resource selects all nodes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">priorityClassName</span></code></p></td>
<td><p>Specifies the priority class for the driver pod.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">system-node-critical</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rdma.enabled</span></code></p></td>
<td><p>Specifies whether to enable GPUDirect RDMA.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">repository</span></code></p></td>
<td><p>Specifies the container registry that contains the driver container.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nvcr.io/nvidia</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">useOpenKernelModules</span></code></p></td>
<td><p>Specifies to use the NVIDIA Open GPU Kernel modules.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tolerations</span></code></p></td>
<td><p>Specifies a set of tolerations to apply to the driver pod.</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">usePrecompiled</span></code></p></td>
<td><p>When set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, the Operator deploys a driver container image
with a precompiled driver.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">version</span></code></p></td>
<td><p>Specifies the GPU driver version to install.
For a data-center driver, specify a value like <code class="docutils literal notranslate"><span class="pre">535.104.12</span></code>.
If you set <code class="docutils literal notranslate"><span class="pre">usePrecompiled</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>, specify the driver branch, such as <code class="docutils literal notranslate"><span class="pre">535</span></code>.</p></td>
<td><p>Refer to the <a class="reference internal" href="platform-support.html#operator-component-matrix"><span class="std std-ref">GPU Operator Component Matrix</span></a>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="installing-the-nvidia-gpu-operator">
<h2>Installing the NVIDIA GPU Operator<a class="headerlink" href="#installing-the-nvidia-gpu-operator" title="Permalink to this headline"></a></h2>
<p>Perform the following steps to install the GPU Operator and use the NVIDIA driver custom resources.</p>
<ol class="arabic">
<li><p>Optional: If you want to run more than one driver type or version in the cluster,
label the worker nodes to identify the driver type and version to install on each node:</p>
<p><em>Example</em></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl label node &lt;node-name&gt; --overwrite driver.version<span class="o">=</span><span class="m">525</span>.125.06
</pre></div>
</div>
<ul class="simple">
<li><p>To use a mix of driver types, such as vGPU, label nodes for the driver type.</p></li>
<li><p>To use a mix of driver versions, label the nodes for the different versions.</p></li>
<li><p>To use a mix of conventional drivers and precompiled driver containers, label the nodes for the different types.</p></li>
</ul>
</li>
<li><p>Install the Operator.</p>
<ul>
<li><p>Add the NVIDIA Helm repository:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>helm repo add nvidia https://helm.ngc.nvidia.com/nvidia <span class="se">\</span>
    <span class="o">&amp;&amp;</span> helm repo update
</pre></div>
</div>
</li>
<li><p>Install the Operator and specify at least the <code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">driver.nvidiaDriverCRD.enabled=true</span></code> argument:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>helm install --wait --generate-name <span class="se">\</span>
    -n gpu-operator --create-namespace <span class="se">\</span>
    nvidia/gpu-operator <span class="se">\</span>
    --version<span class="o">=</span>v24.9.1
<span class="go">    --set driver.nvidiaDriverCRD.enabled=true</span>
</pre></div>
</div>
<p>By default, Helm configures a <code class="docutils literal notranslate"><span class="pre">default</span></code> NVIDIA driver custom resource during installation.
To prevent configuring the default custom resource, also specify <code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">driver.nvidiaDriverCRD.deployDefaultCR=false</span></code>.</p>
</li>
</ul>
</li>
<li><p>Apply NVIDIA driver custom resources manifests to install the NVIDIA GPU driver version, type, and so on for your nodes.
Refer to the sample manifests.</p></li>
</ol>
</section>
<section id="sample-nvidia-driver-manifests">
<h2>Sample NVIDIA Driver Manifests<a class="headerlink" href="#sample-nvidia-driver-manifests" title="Permalink to this headline"></a></h2>
<section id="one-driver-type-and-version-on-all-nodes">
<h3>One Driver Type and Version on All Nodes<a class="headerlink" href="#one-driver-type-and-version-on-all-nodes" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Optional: Remove previously applied node labels.</p></li>
<li><p>Create a file, such as <code class="docutils literal notranslate"><span class="pre">nvd-all.yaml</span></code>, with contents like the following:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia.com/v1alpha1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NVIDIADriver</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo-all</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">driverType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu</span><span class="w"></span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">driver</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">manager</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">rdma</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">    </span><span class="nt">useHostMofed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">gds</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia</span><span class="w"></span>
<span class="w">  </span><span class="nt">startupProbe</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">failureThreshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">120</span><span class="w"></span>
<span class="w">    </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class="w"></span>
<span class="w">    </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w"></span>
<span class="w">    </span><span class="nt">timeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class="w"></span>
<span class="w">  </span><span class="nt">usePrecompiled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">535.104.12</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Because the manifest does not include a <code class="docutils literal notranslate"><span class="pre">nodeSelector</span></code> field, the driver custom
resource selects all nodes in the cluster that have an NVIDIA GPU.</p>
</div>
</li>
<li><p>Apply the manfiest:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl apply -n gpu-operator -f nvd-all.yaml
</pre></div>
</div>
</li>
<li><p>Optional: Monitor the progress:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl get events -n gpu-operator --sort-by<span class="o">=</span><span class="s1">&#39;.lastTimestamp&#39;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="multiple-driver-versions">
<h3>Multiple Driver Versions<a class="headerlink" href="#multiple-driver-versions" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Label the nodes.</p>
<ul>
<li><p>On some nodes, apply a label like the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl label node &lt;node-name&gt; --overwrite driver.config<span class="o">=</span><span class="s2">&quot;gold&quot;</span>
</pre></div>
</div>
</li>
<li><p>On other nodes, apply a label like the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl label node &lt;node-name&gt; --overwrite driver.config<span class="o">=</span><span class="s2">&quot;silver&quot;</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Create a file, such as <code class="docutils literal notranslate"><span class="pre">nvd-driver-multiple.yaml</span></code>, with contents like the following:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia.com/v1alpha1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NVIDIADriver</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo-gold</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">driverType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu</span><span class="w"></span>
<span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">driver</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">manager</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">nodeSelector</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">driver.config</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gold&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia</span><span class="w"></span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;535.104.12&quot;</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia.com/v1alpha1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NVIDIADriver</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo-silver</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">driverType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu</span><span class="w"></span>
<span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">driver</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">manager</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">nodeSelector</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">driver.config</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;silver&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia</span><span class="w"></span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;470.141.10&quot;</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Apply the manfiest:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl apply -n gpu-operator -f nvd-driver-multiple.yaml
</pre></div>
</div>
</li>
<li><p>Optional: Monitor the progress:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl get events -n gpu-operator --sort-by<span class="o">=</span><span class="s1">&#39;.lastTimestamp&#39;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="one-precompiled-driver-container-on-all-nodes">
<h3>One Precompiled Driver Container on All Nodes<a class="headerlink" href="#one-precompiled-driver-container-on-all-nodes" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Optional: Remove previously applied node labels.</p></li>
<li><p>Create a file, such as <code class="docutils literal notranslate"><span class="pre">nvd-precompiled-all.yaml</span></code>, with contents like the following:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia.com/v1alpha1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NVIDIADriver</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo-precomp-all</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">driverType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu</span><span class="w"></span>
<span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">driver</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">manager</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">nodeSelector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia</span><span class="w"></span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">usePrecompiled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;535&quot;</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Because the manfiest does not include a <code class="docutils literal notranslate"><span class="pre">nodeSelector</span></code> field, the driver custom
resource selects all nodes in the cluster that have an NVIDIA GPU.</p>
</div>
</li>
<li><p>Apply the manfiest:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl apply -n gpu-operator -f nvd-precompiled-all.yaml
</pre></div>
</div>
</li>
<li><p>Optional: Monitor the progress:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl get events -n gpu-operator --sort-by<span class="o">=</span><span class="s1">&#39;.lastTimestamp&#39;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="precompiled-driver-container-on-some-nodes">
<h3>Precompiled Driver Container on Some Nodes<a class="headerlink" href="#precompiled-driver-container-on-some-nodes" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Label the nodes like the following sample:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl label node &lt;node-name&gt; --overwrite driver.precompiled<span class="o">=</span><span class="s2">&quot;true&quot;</span>
<span class="gp">$ </span>kubectl label node &lt;node-name&gt; --overwrite driver.version<span class="o">=</span><span class="s2">&quot;535&quot;</span>
</pre></div>
</div>
</li>
<li><p>Create a file, such as <code class="docutils literal notranslate"><span class="pre">nvd-precomiled-some.yaml</span></code>, with contents like the following:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia.com/v1alpha1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NVIDIADriver</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo-precomp</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">driverType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu</span><span class="w"></span>
<span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">driver</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class="w"></span>
<span class="w">  </span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">manager</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">nodeSelector</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">driver.precompiled</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">driver.version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;535&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia</span><span class="w"></span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">usePrecompiled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;535&quot;</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Apply the manfiest:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl apply -n gpu-operator -f nvd-precompiled-some.yaml
</pre></div>
</div>
</li>
<li><p>Optional: Monitor the progress:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl get events -n gpu-operator --sort-by<span class="o">=</span><span class="s1">&#39;.lastTimestamp&#39;</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="upgrading-the-nvidia-gpu-driver">
<span id="nvd-upgrade"></span><h2>Upgrading the NVIDIA GPU Driver<a class="headerlink" href="#upgrading-the-nvidia-gpu-driver" title="Permalink to this headline"></a></h2>
<p>You can upgrade the driver version by editing or patching the NVIDIA driver custom resource.</p>
<p>When you update the custom resource, the Operator performs a rolling update of the pods in the affected daemon set.</p>
<ol class="arabic">
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">driver.version</span></code> field in the driver custom resource:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl patch nvidiadriver/demo-silver --type<span class="o">=</span><span class="s1">&#39;json&#39;</span> <span class="se">\</span>
    -p<span class="o">=</span><span class="s1">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/version&quot;, &quot;value&quot;: &quot;525.125.06&quot;}]&#39;</span>
</pre></div>
</div>
</li>
<li><p>Optional: Monitor the progress:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl get pods -n gpu-operator -l app.kubernetes.io/component<span class="o">=</span>nvidia-driver
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">NAME                                             READY   STATUS        RESTARTS   AGE</span>
<span class="go">nvidia-gpu-driver-ubuntu20.04-788484b9bb-6zhd9   1/1     Running       0          5m1s</span>
<span class="go">nvidia-gpu-driver-ubuntu22.04-8896c4bf7-7s68q    1/1     Terminating   0          37m</span>
<span class="go">nvidia-gpu-driver-ubuntu22.04-8896c4bf7-jm74l    1/1     Running       0          37m</span>
</pre></div>
</div>
</li>
</ol>
<p>Eventually, the Operator replaces the pods that used the previous driver version with pods that use the updated driver version.</p>
</section>
<section id="troubleshooting">
<span id="nvd-troubleshooting"></span><h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline"></a></h2>
<p>If the driver daemon sets and pods are not running as you expect, perform the following steps.</p>
<ol class="arabic">
<li><p>Display the NVIDIA driver custom resources:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl get nvidiadrivers
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">NAME           STATUS     AGE</span>
<span class="go">default        notReady   2023-10-13T14:03:24Z</span>
<span class="go">demo-precomp   notReady   2023-10-13T14:21:55Z</span>
</pre></div>
</div>
<p>It is normal for the status to report not ready shortly after modifying the resource.</p>
</li>
<li><p>If the status is not ready, describe the resource:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl describe nvidiadriver demo-precomp
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">Name:         demo-precomp</span>
<span class="go">...</span>
<span class="go">  Version:          535.104.05</span>
<span class="go">Status:</span>
<span class="go">  Conditions:</span>
<span class="go">    Last Transition Time:  2023-10-13T14:33:30Z</span>
<span class="go">    Message:</span>
<span class="go">    Reason:                Error</span>
<span class="go">    Status:                False</span>
<span class="go">    Type:                  Ready</span>
<span class="go">    Last Transition Time:  2023-10-13T14:33:30Z</span>
<span class="go">    Message:               Waiting for driver pod to be ready</span>
<span class="go">    Reason:                DriverNotReady</span>
<span class="go">    Status:                True</span>
<span class="go">    Type:                  Error</span>
<span class="go">  State:                   notReady</span>
</pre></div>
</div>
</li>
<li><p>Display the node selectors for the driver daemon sets.
The selectors are set from the NVIDIA driver custom resources:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl get -n gpu-operator ds -l app.kubernetes.io/component<span class="o">=</span>nvidia-driver
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">NAME                                       DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR                                                                                                                                                                                             AGE</span>
<span class="go">nvidia-gpu-driver-ubuntu20.04-788484b9bb   1         1         1       1            1           driver.config=silver,feature.node.kubernetes.io/system-os_release.ID=ubuntu,feature.node.kubernetes.io/system-os_release.VERSION_ID=20.04,nvidia.com/gpu.deploy.driver=true,nvidia.com/gpu.present=true   10m</span>
<span class="go">nvidia-gpu-driver-ubuntu22.04-8896c4bf7    2         2         2       2            2           driver.config=gold,feature.node.kubernetes.io/system-os_release.ID=ubuntu,feature.node.kubernetes.io/system-os_release.VERSION_ID=22.04,nvidia.com/gpu.deploy.driver=true,nvidia.com/gpu.present=true     10m</span>
</pre></div>
</div>
</li>
<li><p>View the logs from the GPU Operator pod:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl logs -n gpu-operator deployment/gpu-operator
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;info&quot;</span><span class="p">,</span><span class="nt">&quot;ts&quot;</span><span class="p">:</span><span class="mf">1697223780.333307</span><span class="p">,</span><span class="nt">&quot;logger&quot;</span><span class="p">:</span><span class="s2">&quot;controllers.Upgrade&quot;</span><span class="p">,</span><span class="nt">&quot;msg&quot;</span><span class="p">:</span><span class="s2">&quot;Node hosting a driver pod&quot;</span><span class="p">,</span><span class="nt">&quot;node&quot;</span><span class="p">:</span><span class="s2">&quot;worker-2&quot;</span><span class="p">,</span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="s2">&quot;upgrade-done&quot;</span><span class="p">}</span><span class="w"></span>
<span class="p">{</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;info&quot;</span><span class="p">,</span><span class="nt">&quot;ts&quot;</span><span class="p">:</span><span class="mf">1697223780.3376482</span><span class="p">,</span><span class="nt">&quot;logger&quot;</span><span class="p">:</span><span class="s2">&quot;controllers.Upgrade&quot;</span><span class="p">,</span><span class="nt">&quot;msg&quot;</span><span class="p">:</span><span class="s2">&quot;Node hosting a driver pod&quot;</span><span class="p">,</span><span class="nt">&quot;node&quot;</span><span class="p">:</span><span class="s2">&quot;worker-1&quot;</span><span class="p">,</span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="s2">&quot;upgrade-done&quot;</span><span class="p">}</span><span class="w"></span>
<span class="p">{</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;info&quot;</span><span class="p">,</span><span class="nt">&quot;ts&quot;</span><span class="p">:</span><span class="mf">1697223780.345211</span><span class="p">,</span><span class="nt">&quot;logger&quot;</span><span class="p">:</span><span class="s2">&quot;controllers.Upgrade&quot;</span><span class="p">,</span><span class="nt">&quot;msg&quot;</span><span class="p">:</span><span class="s2">&quot;Node hosting a driver pod&quot;</span><span class="p">,</span><span class="nt">&quot;node&quot;</span><span class="p">:</span><span class="s2">&quot;worker-0&quot;</span><span class="p">,</span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="s2">&quot;upgrade-done&quot;</span><span class="p">}</span><span class="w"></span>
<span class="p">{</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;error&quot;</span><span class="p">,</span><span class="nt">&quot;ts&quot;</span><span class="p">:</span><span class="mf">1697223780.3452845</span><span class="p">,</span><span class="nt">&quot;logger&quot;</span><span class="p">:</span><span class="s2">&quot;controllers.Upgrade&quot;</span><span class="p">,</span><span class="nt">&quot;msg&quot;</span><span class="p">:</span><span class="s2">&quot;Failed to build node upgrade state for pod&quot;</span><span class="p">,</span><span class="nt">&quot;pod&quot;</span><span class="p">:{</span><span class="nt">&quot;namespace&quot;</span><span class="p">:</span><span class="s2">&quot;gpu-operator&quot;</span><span class="p">,</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;nvidia-gpu-driver-ubuntu22.04-6d4df6b96f-c6hfd&quot;</span><span class="p">},</span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="s2">&quot;unable to get node : resource name may not be empty&quot;</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="precompiled-drivers.html" class="btn btn-neutral float-left" title="Precompiled Driver Containers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cdi.html" class="btn btn-neutral float-right" title="Container Device Interface Support in the GPU Operator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
<img src="_static/NVIDIA-LogoBlack.svg" class="only-light"/>
<img src="_static/NVIDIA-LogoWhite.svg" class="only-dark"/>
<p class="notices">
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/" target="_blank">Privacy Policy</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/" target="_blank">Manage My Privacy</a>
|
<a href="https://www.nvidia.com/en-us/preferences/start/" target="_blank">Do Not Sell or Share My Data</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/" target="_blank">Terms of Service</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/accessibility/" target="_blank">Accessibility</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/company-policies/" target="_blank">Corporate Policies</a>
|
<a href="https://www.nvidia.com/en-us/product-security/" target="_blank">Product Security</a>
|
<a href="https://www.nvidia.com/en-us/contact/" target="_blank">Contact</a>
</p>
<p>
  Copyright &#169; 2020-2025, NVIDIA Corporation.
</p>

    <p>
      <span class="lastupdated">Last updated on Jan 23, 2025.
      </span></p>
<script type="text/javascript">if (typeof _satellite !== "undefined"){ _satellite.pageBottom();}</script>

  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WBRZJBCJEW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WBRZJBCJEW', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>