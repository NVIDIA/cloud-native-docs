<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mirantis Kubernetes Engine with the NVIDIA GPU Operator &mdash; Partner Validated Configurations with NVIDIA GPU Operator 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" type="text/css" />
      <link rel="stylesheet" href="_static/omni-style.css" type="text/css" />
      <link rel="stylesheet" href="_static/api-styles.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/mermaid-init.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/design-tabs.js"></script>
        <script src="_static/version.js"></script>
        <script src="_static/social-media.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="About Partner-Validated Configurations" href="index.html" />
 
<script src="https://assets.adobedtm.com/5d4962a43b79/c1061d2c5e7b/launch-191c2462b890.min.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/nvidia-logo-white.png" class="logo" alt="Logo"/>
          </a>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Partner-Validated Configurations</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">About Partner-Validated Configurations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Mirantis Kubernetes Engine with the NVIDIA GPU Operator</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Partner Validated Configurations with NVIDIA GPU Operator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
<div> <!-- class="omni-version-warning" -->
  <p class="omni-version-warning-content"> Upgrade to NVIDIA Container Toolkit v1.16.2 or GPU Operator v24.6.2 to install a critical security update.<br/>
  Refer to <a href="https://nvidia.custhelp.com/app/answers/detail/a_id/5582">Security Bulletin: NVIDIA Container Toolkit - September 2024</a> for more information.</p>
</div>

<li>
    <a href="https://docs.nvidia.com">NVIDIA Docs Hub</a>
    <i class="fa fa-chevron-right" aria-hidden="true"></i>
</li>
<li>
    <a href="https://docs.nvidia.com/datacenter/cloud-native/">NVIDIA Cloud Native Technologies</a>
    <i class="fa fa-chevron-right" aria-hidden="true"></i>
</li>
<li>Mirantis Kubernetes Engine with the NVIDIA GPU Operator</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="prod-name-long-with-the-nvidia-gpu-operator">
<h1>Mirantis Kubernetes Engine with the NVIDIA GPU Operator<a class="headerlink" href="#prod-name-long-with-the-nvidia-gpu-operator" title="Permalink to this headline"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#about-prod-name-short-with-the-gpu-operator" id="id1">About MKE with the GPU Operator</a></p></li>
<li><p><a class="reference internal" href="#validated-configuration-matrix" id="id2">Validated Configuration Matrix</a></p></li>
<li><p><a class="reference internal" href="#prerequisites" id="id3">Prerequisites</a></p></li>
<li><p><a class="reference internal" href="#procedure" id="id4">Procedure</a></p></li>
<li><p><a class="reference internal" href="#verifying-prod-name-short-with-the-gpu-operator" id="id5">Verifying MKE with the GPU Operator</a></p></li>
<li><p><a class="reference internal" href="#getting-support" id="id6">Getting Support</a></p></li>
<li><p><a class="reference internal" href="#related-information" id="id7">Related information</a></p></li>
</ul>
</div>
<section id="about-prod-name-short-with-the-gpu-operator">
<h2>About MKE with the GPU Operator<a class="headerlink" href="#about-prod-name-short-with-the-gpu-operator" title="Permalink to this headline"></a></h2>
<p>Mirantis Kubernetes Engine (MKE) gives you the power to build, run, and scale cloud-native
applications—the way that works for you.
Increase developer efficiency and release frequency while reducing cost.</p>
<p>The NVIDIA GPU Operator uses the operator framework within Kubernetes to automate
both the deployment and management of all NVIDIA software components needed to provision NVIDIA GPUs.
These components include the NVIDIA GPU drivers to enable CUDA, Kubernetes device plugin for GPUs,
the NVIDIA Container Toolkit, automatic node labeling using GFD, DCGM based monitoring and others.</p>
</section>
<section id="validated-configuration-matrix">
<h2>Validated Configuration Matrix<a class="headerlink" href="#validated-configuration-matrix" title="Permalink to this headline"></a></h2>
<p>Mirantis Kubernetes Engine has self-validated with the following components and versions:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><div class="line-block">
<div class="line">NVIDIA</div>
<div class="line">GPU</div>
<div class="line">Operator</div>
</div>
</th>
<th class="head"><div class="line-block">
<div class="line">Operating</div>
<div class="line">System</div>
</div>
</th>
<th class="head"><div class="line-block">
<div class="line">Container</div>
<div class="line">Runtime</div>
</div>
</th>
<th class="head"><p>Kubernetes</p></th>
<th class="head"><p>Helm</p></th>
<th class="head"><p>NVIDIA GPU</p></th>
<th class="head"><p>Hardware Model</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MKE 3.6.2+ and 3.5.7+</p></td>
<td><p>v23.3.1</p></td>
<td><div class="line-block">
<div class="line">RHEL 8.7</div>
<div class="line">Ubuntu 20.04, 18.04</div>
</div>
</td>
<td><p>Mirantis Container Runtime (MCR) 20.10.15+ and 23.0.3+</p></td>
<td><p>1.21.12+ and 1.24.6+</p></td>
<td><p>Helm v3</p></td>
<td><div class="line-block">
<div class="line">NVIDIA HGX H100</div>
<div class="line">NVIDIA H100</div>
<div class="line">NVIDIA A100</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Dell PowerEdge R720</div>
<div class="line">Dell CN-QVWT90-70163-2BJ-00LV-A02</div>
<div class="line">2x Intel Xeon E5-2690</div>
<div class="line">24x RAM 8GB</div>
<div class="line">1x SSD 480GB Micron 5300 PRO</div>
<div class="line">1x SSD 960GB Micron 5300 PRO</div>
<div class="line">1x GPU NVIDIA P1001B A100 PCIe AMPERE 40GB</div>
<div class="line">1x RAID Controller PERC H710</div>
<div class="line">1x Network card FM487</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"></a></h2>
<ul>
<li><p>A running MKE cluster with at least one control plane node and two worker nodes.
The recommended configuration is at least three control plane nodes and at least two worker nodes.</p></li>
<li><p>At least one worker node with an NVIDIA GPU physically installed.
The GPU Operator can locate the GPU and label the node accordingly.</p></li>
<li><p>A seed node to connect to the MKE instance, with Helm 3.x installed on the seed node.</p></li>
<li><p>The kubeconfig file for the MKE cluster on the seed node.
You can get the file from the MKE web interface by downloading a client bundle.
The configuration is in the <code class="docutils literal notranslate"><span class="pre">kube.yml</span></code> file.</p>
<p>Alternatively, if the MKE cluster is a managed cluster of a Mirantis Container Cloud (MCC) instance,
you can use the MCC management console to get the kubeconfig file.
In this case, the MKE web interface can be accessed from the MCC web interface.
You can get the kubeconfig file for the managed cluster directly from the MCC web interface.</p>
</li>
<li><p>You have an MKE administrator user name and password, and you have the MKE host URL.</p></li>
</ul>
</section>
<section id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline"></a></h2>
<p>Perform the following steps to prepare the MKE cluster:</p>
<ol class="arabic">
<li><p>MKE does not apply a label to worker nodes.
Ensure that the worker nodes are labeled:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl label node &lt;node-name&gt; node-role.kubernetes.io/worker<span class="o">=</span><span class="s1">&#39;&#39;</span>
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">node/demo-node labeled</span>
</pre></div>
</div>
</li>
<li><p>Create the namespace for the GPU Operator:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl create ns gpu-operator
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">namespace/gpu-operator created</span>
</pre></div>
</div>
</li>
<li><p>Store the credentials and connection information in environment variables:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">export</span> <span class="nv">MKE_USERNAME</span><span class="o">=</span>&lt;mke-username&gt; <span class="se">\</span>
    <span class="nv">MKE_PASSWORD</span><span class="o">=</span>&lt;mke-password&gt; <span class="se">\</span>
    <span class="nv">MKE_HOST</span><span class="o">=</span>&lt;mke-fqdn-or-ip-address&gt;
</pre></div>
</div>
</li>
<li><p>Get an API key from MKE so that you can make API calls later:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">AUTHTOKEN</span><span class="o">=</span><span class="k">$(</span>curl --silent --insecure --data <span class="se">\</span>
    <span class="s1">&#39;{&quot;username&quot;:&quot;&#39;</span><span class="nv">$MKE_USERNAME</span><span class="s1">&#39;&quot;,&quot;password&quot;:&quot;&#39;</span><span class="nv">$MKE_PASSWORD</span><span class="s1">&#39;&quot;}&#39;</span> <span class="se">\</span>
    https://<span class="nv">$MKE_HOST</span>/auth/login <span class="p">|</span> jq --raw-output .auth_token<span class="k">)</span>
</pre></div>
</div>
</li>
<li><p>Download the MKE configuration file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl --silent --insecure -X GET <span class="s2">&quot;https://</span><span class="nv">$MKE_HOST</span><span class="s2">/api/ucp/config-toml&quot;</span> <span class="se">\</span>
    -H <span class="s2">&quot;accept: application/toml&quot;</span> -H <span class="s2">&quot;Authorization: Bearer </span><span class="nv">$AUTHTOKEN</span><span class="s2">&quot;</span>  <span class="se">\</span>
    &gt; mke-config-gpu.toml
</pre></div>
</div>
</li>
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">mke-config-gpu.toml</span></code> file and update the values like the following example:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">priv_attributes_allowed_for_user_accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;hostbindmounts&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;privileged&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hostPID&quot;</span><span class="p">]</span><span class="w"></span>
<span class="w">     </span><span class="n">priv_attributes_user_accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;gpu-operator:gpu-operator&quot;</span><span class="p">]</span><span class="w"></span>
<span class="n">priv_attributes_allowed_for_service_accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;hostbindmounts&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;privileged&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="s">&quot;hostIPC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hostPID&quot;</span><span class="p">]</span><span class="w"></span>
<span class="n">priv_attributes_service_accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;gpu-operator:nvidia-gpu-feature-discovery&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="s">&quot;gpu-operator:nvidia-driver&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;gpu-operator:nvidia-container-toolkit&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="s">&quot;gpu-operator:nvidia-operator-validator&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;gpu-operator:nvidia-device-plugin&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="s">&quot;gpu-operator:nvidia-dcgm-exporter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;gpu-operator:nvidia-mig-manager&quot;</span><span class="p">]</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Upload the edited MKE configuration file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl --silent --insecure -X PUT -H <span class="s2">&quot;accept: application/toml&quot;</span> <span class="se">\</span>
    -H <span class="s2">&quot;Authorization: Bearer </span><span class="nv">$AUTHTOKEN</span><span class="s2">&quot;</span> --upload-file <span class="s1">&#39;mke-config-gpu.toml&#39;</span> <span class="se">\</span>
    https://<span class="nv">$MKE_HOST</span>/api/ucp/config-toml
</pre></div>
</div>
</li>
</ol>
<p>The MKE cluster is ready for you to install the GPU Operator with Helm.
Refer to <a class="reference external" href="https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/latest/getting-started.html#install-gpu-operator" title="(in NVIDIA GPU Operator)"><span>Installing the NVIDIA GPU Operator</span></a> for more information.</p>
</section>
<section id="verifying-prod-name-short-with-the-gpu-operator">
<h2>Verifying MKE with the GPU Operator<a class="headerlink" href="#verifying-prod-name-short-with-the-gpu-operator" title="Permalink to this headline"></a></h2>
<ul>
<li><p>View the nodes and number of NVIDIA GPUs on each node:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl get nodes <span class="s2">&quot;-o=custom-columns=NAME:.metadata.name,GPUs:.metadata.labels.nvidia\.com/gpu\.count&quot;</span>
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">NAME        GPUs</span>
<span class="go">demo-node   4</span>
<span class="go">...</span>
</pre></div>
</div>
<p>A response like the preceding example indicates that the GPU Operator and
operands are running correctly.</p>
</li>
</ul>
<p>Refer to <a class="reference external" href="https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/latest/getting-started.html#running-sample-gpu-applications" title="(in NVIDIA GPU Operator)"><span>Verification: Running Sample GPU Applications</span></a> to verify the installation.</p>
</section>
<section id="getting-support">
<h2>Getting Support<a class="headerlink" href="#getting-support" title="Permalink to this headline"></a></h2>
<p>Refer to the MKE product documentation for information about working with MKE.</p>
</section>
<section id="related-information">
<h2>Related information<a class="headerlink" href="#related-information" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.mirantis.com/mke/3.6/overview.html">https://docs.mirantis.com/mke/3.6/overview.html</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="About Partner-Validated Configurations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
<img src="_static/NVIDIA-LogoBlack.svg" class="only-light"/>
<img src="_static/NVIDIA-LogoWhite.svg" class="only-dark"/>
<p class="notices">
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/" target="_blank">Privacy Policy</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/" target="_blank">Manage My Privacy</a>
|
<a href="https://www.nvidia.com/en-us/preferences/start/" target="_blank">Do Not Sell or Share My Data</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/" target="_blank">Terms of Service</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/accessibility/" target="_blank">Accessibility</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/company-policies/" target="_blank">Corporate Policies</a>
|
<a href="https://www.nvidia.com/en-us/product-security/" target="_blank">Product Security</a>
|
<a href="https://www.nvidia.com/en-us/contact/" target="_blank">Contact</a>
</p>
<p>
  Copyright &#169; 2023-2024, NVIDIA Corporation.
</p>

    <p>
      <span class="lastupdated">Last updated on Oct 18, 2024.
      </span></p>
<script type="text/javascript">if (typeof _satellite !== "undefined"){ _satellite.pageBottom();}</script>

  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>