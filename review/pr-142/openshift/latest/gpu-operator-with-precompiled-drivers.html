


<!DOCTYPE html>


<html data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Precompiled Drivers for the NVIDIA GPU Operator for RHCOS &#8212; NVIDIA GPU Operator on Red Hat OpenShift Container Platform</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/nvidia-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/mermaid-init.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gpu-operator-with-precompiled-drivers';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '../versions1.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '24.9.2';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <script src="_static/version.js"></script>
    <script src="_static/social-media.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting" href="troubleshooting-gpu-ocp.html" />
    <link rel="prev" title="NVIDIA GPU Operator with OpenShift Virtualization" href="openshift-virtualization.html" />


  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  <meta name="docsearch:version" content="" />
    <meta name="docbuild:last-update" content="Jan 29, 2025"/>




  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA GPU Operator on Red Hat OpenShift Container Platform - Home"/>
    <img src="_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="NVIDIA GPU Operator on Red Hat OpenShift Container Platform - Home"/>
  
  
    <p class="title logo__title">NVIDIA GPU Operator on Red Hat OpenShift Container Platform</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA GPU Operator on Red Hat OpenShift Container Platform - Home"/>
    <img src="_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="NVIDIA GPU Operator on Red Hat OpenShift Container Platform - Home"/>
  
  
    <p class="title logo__title">NVIDIA GPU Operator on Red Hat OpenShift Container Platform</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">


<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="steps-overview.html">Installation and Upgrade Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-nfd.html">NFD Operator Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-ocp.html">GPU Operator Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nvaie-with-ocp.html">NVIDIA AI Enterprise with OpenShift</a></li>
<li class="toctree-l1"><a class="reference internal" href="mig-ocp.html">MIG Support in OpenShift Container Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="clean-up.html">Cleanup</a></li>
<li class="toctree-l1"><a class="reference internal" href="mirror-gpu-ocp-disconnected.html">Deploy GPU Operators in a disconnected or airgapped environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="enable-gpu-monitoring-dashboard.html">Enabling the GPU Monitoring Dashboard</a></li>

<li class="toctree-l1"><a class="reference internal" href="time-slicing-gpus-in-openshift.html">Time-slicing NVIDIA GPUs in OpenShift</a></li>
<li class="toctree-l1"><a class="reference internal" href="openshift-virtualization.html">NVIDIA GPU Operator with OpenShift Virtualization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Precompiled Drivers for the NVIDIA GPU Operator for RHCOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting-gpu-ocp.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix-ocp.html">Appendix</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">
<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    <li class="breadcrumb-item breadcrumb-home">
      <a href="https://docs.nvidia.com">NVIDIA Docs Hub</a>
    </li>
    <li class="breadcrumb-item">
      <a href="https://docs.nvidia.com/datacenter/cloud-native">Cloud Native Technologies</a>
    </li>
    <li class="breadcrumb-item">
      <a href="index.html">NVIDIA GPU Operator on Red Hat OpenShift Container Platform</a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Precompiled Drivers for the NVIDIA GPU Operator for RHCOS</li>
  </ul>
</nav></div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="precompiled-drivers-for-the-nvidia-gpu-operator-for-rhcos">
<span id="gpu-operator-with-precompiled-drivers"></span><h1>Precompiled Drivers for the NVIDIA GPU Operator for RHCOS<a class="headerlink" href="#precompiled-drivers-for-the-nvidia-gpu-operator-for-rhcos" title="Permalink to this headline">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Technology Preview features are not supported in production environments and are not functionally complete. Technology Preview features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process. These releases may not have any documentation, and testing is limited.</p>
</div>
<section id="about-precompiled-driver-containers">
<h2>About Precompiled Driver Containers<a class="headerlink" href="#about-precompiled-driver-containers" title="Permalink to this headline">#</a></h2>
<p>By default, NVIDIA GPU drivers are built on the cluster nodes when you deploy the GPU Operator.
Driver compilation and packaging is done on every Kubernetes node, which leads to bursts of compute demand, waste of resources, and long provisioning times.
In contrast, using container images with precompiled drivers makes the drivers immediately available on all nodes, resulting in faster provisioning and cost savings in public cloud deployments.</p>
</section>
<section id="limitations-and-restrictions">
<h2>Limitations and Restrictions<a class="headerlink" href="#limitations-and-restrictions" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>NVIDIA does not provide precompiled driver images for Red Hat OpenShift. Such images have to be custom built and hosted in a public or private image registry.</p></li>
<li><p>NVIDIA provides limited support for custom driver container images.</p></li>
<li><p>Precompiled driver containers do not support NVIDIA vGPU or GPUDirect Storage (GDS).</p></li>
<li><p>Precompiled driver container images for Red Hat OpenShift Container Platform have been tested with the following versions:</p>
<ul>
<li><p>4.12 (RHEL 8.6)</p></li>
<li><p>4.13 (RHEL 9.2)</p></li>
</ul>
</li>
</ul>
</section>
<section id="building-a-precompiled-driver-image">
<h2>Building a Precompiled Driver Image<a class="headerlink" href="#building-a-precompiled-driver-image" title="Permalink to this headline">#</a></h2>
<p>Perform the following steps to build a custom driver image for use with Red Hat OpenShift Contain Platform.</p>
<p class="rubric">Prerequisites</p>
<ul>
<li><p>You have access to a container registry, such as NVIDIA NGC Private Registry, Red Hat Quay, or the OpenShift internal container registry, and can push container images to the registry.</p></li>
<li><p>You have a valid Red Hat subscription with an activation key.</p></li>
<li><p>You have a Red Hat OpenShift pull secret.</p></li>
<li><p>Your build machine has access to the internet to download operating system packages.</p></li>
<li><p>You know a CUDA version, such as <code class="docutils literal notranslate"><span class="pre">12.1.0</span></code>, that you want to use.</p>
<p>One way to find a supported CUDA version for your operating system is to access the NVIDIA GPU Cloud registry at <a class="reference external" href="https://catalog.ngc.nvidia.com/orgs/nvidia/containers/cuda/tags">CUDA | NVIDIA NGC</a> and view the tags. Use the search field to filter the tags, such as <code class="docutils literal notranslate"><span class="pre">base-ubi8</span></code> for RHEL 8   and <code class="docutils literal notranslate"><span class="pre">base-ubi9</span></code> for RHEL 9. The filtered results show the CUDA versions, such as <code class="docutils literal notranslate"><span class="pre">12.1.0</span></code>, <code class="docutils literal notranslate"><span class="pre">12.0.1</span></code>, <code class="docutils literal notranslate"><span class="pre">12.0.0</span></code>, and so on.</p>
</li>
<li><p>You know the GPU driver version, such as <code class="docutils literal notranslate"><span class="pre">525.105.17</span></code>, that you want to use.</p></li>
</ul>
<p class="rubric">Procedure</p>
<ol class="arabic">
<li><p>Clone the driver container repository:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git clone https://gitlab.com/nvidia/container-images/driver
</pre></div>
</div>
</li>
<li><p>Change the directory to <code class="docutils literal notranslate"><span class="pre">rhel8/precompiled</span></code> under the cloned repository. You can build precompiled driver images for versions 8 and 9 of RHEL from this directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> driver/rhel8/precompiled
</pre></div>
</div>
</li>
<li><p>Create a Red Hat Customer Portal Activation Key and note your Red Hat Subscription Management (RHSM) organization ID. These are to install packages during a build. Save the values to files, for example, <code class="docutils literal notranslate"><span class="pre">$HOME/rhsm_org</span></code> and <code class="docutils literal notranslate"><span class="pre">$HOME/rhsm_activationkey</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RHSM_ORG_FILE=$HOME/rhsm_org</span>
<span class="go">export RHSM_ACTIVATIONKEY_FILE=$HOME/rhsm_activationkey</span>
</pre></div>
</div>
</li>
<li><p>Download your Red Hat OpenShift pull secret and store it in a file, for example, <code class="docutils literal notranslate"><span class="pre">${HOME}/pull-secret</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export PULL_SECRET_FILE=$HOME/pull-secret.txt</span>
</pre></div>
</div>
</li>
<li><p>Set the Red Hat OpenShift version and target architecture of your cluster, for example, <code class="docutils literal notranslate"><span class="pre">x86_64</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export OPENSHIFT_VERSION=&quot;4.12.13&quot;</span>
<span class="go">export TARGET_ARCH=&quot;x86_64&quot;</span>
</pre></div>
</div>
</li>
<li><p>Determine the Driver Toolkit (DTK) image for your target Red Hat OpenShift version and architecture:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export DRIVER_TOOLKIT_IMAGE=$(oc adm release info -a $HOME/pull-secret.txt --image-for=driver-toolkit quay.io/openshift-release-dev/ocp-release:${OPENSHIFT_VERSION}-${TARGET_ARCH})</span>
</pre></div>
</div>
</li>
<li><p>Determine the RHEL and kernel versions of your target OpenShift cluster:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RHEL_VERSION=$(podman run --authfile $HOME/pull-secret.txt --rm -ti ${DRIVER_TOOLKIT_IMAGE} cat /etc/driver-toolkit-release.json | jq -r &#39;.RHEL_VERSION&#39;)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RHEL_MAJOR=$(echo &quot;${RHEL_VERSION}&quot; | cut -d &#39;.&#39; -f 1)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export KERNEL_VERSION=$(podman run --authfile $HOME/pull-secret.txt --rm -ti ${DRIVER_TOOLKIT_IMAGE} cat /etc/driver-toolkit-release.json | jq -r &#39;.KERNEL_VERSION&#39;)</span>
</pre></div>
</div>
</li>
<li><p>Set environment variables for the driver and CUDA versions, as well as the image:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export CUDA_VERSION=12.1.0</span>
<span class="go">export CUDA_DIST=ubi${RHEL_MAJOR}</span>
<span class="go">export DRIVER_EPOCH=1</span>
<span class="go">export DRIVER_VERSION=525.105.17</span>
<span class="go">export OS_TAG=rhcos4.12</span>
</pre></div>
</div>
</li>
<li><p>Build and push the image:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">make image image-push</span>
</pre></div>
</div>
</li>
</ol>
<p>Optionally, override the <code class="docutils literal notranslate"><span class="pre">IMAGE_REGISTRY</span></code>, <code class="docutils literal notranslate"><span class="pre">IMAGE_NAME</span></code>, and <code class="docutils literal notranslate"><span class="pre">CONTAINER_TOOL</span></code>. You can also override <code class="docutils literal notranslate"><span class="pre">BUILDER_USER</span></code> and <code class="docutils literal notranslate"><span class="pre">BUILDER_EMAIL</span></code> if you want, otherwise your Git username and email are used. See the Makefile for all available variables.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not set the <code class="docutils literal notranslate"><span class="pre">DRIVER_TYPE</span></code>. The only supported value is currently <code class="docutils literal notranslate"><span class="pre">passthrough</span></code>, which is set by default.</p>
</div>
</section>
<section id="enabling-precompiled-driver-container-support">
<h2>Enabling Precompiled Driver Container Support<a class="headerlink" href="#enabling-precompiled-driver-container-support" title="Permalink to this headline">#</a></h2>
<p class="rubric">Prerequisites</p>
<ul class="simple">
<li><p>You installed the NVIDIA GPU Operator. Refer to <a class="reference internal" href="install-gpu-ocp.html"><span class="doc">Installing the NVIDIA GPU Operator on OpenShift</span></a>.</p></li>
</ul>
<section id="using-the-web-console">
<h3>Using the Web Console<a class="headerlink" href="#using-the-web-console" title="Permalink to this headline">#</a></h3>
<ol class="arabic">
<li><p>In the OpenShift Container Platform web console, from the side menu, select <strong>Operators</strong> &gt; <strong>Installed Operators</strong>, and click <strong>NVIDIA GPU Operator</strong>.</p></li>
<li><p>Select the <strong>ClusterPolicy</strong> tab, then click <strong>Create ClusterPolicy</strong>. The platform assigns the default name <em>gpu-cluster-policy</em>.</p></li>
<li><p>Open the <strong>Driver</strong> section.</p></li>
<li><p>Check the <strong>usePrecompiled</strong> checkbox.</p></li>
<li><p>Specify values for <strong>repository</strong>, <strong>version</strong>, and <strong>image</strong>.</p>
<a class="reference internal image-reference" href="_images/precompiled_driver_config_repository.png"><img alt="_images/precompiled_driver_config_repository.png" src="_images/precompiled_driver_config_repository.png" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="_images/precompiled_driver_config_version_and_image.png"><img alt="_images/precompiled_driver_config_version_and_image.png" src="_images/precompiled_driver_config_version_and_image.png" style="width: 600px;" /></a>
</li>
<li><p>Select <strong>Create</strong>.</p></li>
</ol>
</section>
<section id="using-the-yaml-file">
<h3>Using the YAML File<a class="headerlink" href="#using-the-yaml-file" title="Permalink to this headline">#</a></h3>
<ol class="arabic">
<li><p>Use the procedure <a class="reference internal" href="install-gpu-ocp.html#create-cluster-policy-web-console"><span class="std std-ref">Create the cluster policy using the web console</span></a> to create a cluster policy. Switch to the YAML view while creating the <code class="docutils literal notranslate"><span class="pre">ClusterPolicy</span></code> resource.</p></li>
<li><p>Add precompiled driver image properties:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">driver</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">usePrecompiled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;image_name&gt;</span><span class="w"></span>
<span class="w">    </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;image_registry&gt;</span><span class="w"></span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;driver_version&gt;</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Provide values for <code class="docutils literal notranslate"><span class="pre">image</span></code>, <code class="docutils literal notranslate"><span class="pre">repository</span></code>, and <code class="docutils literal notranslate"><span class="pre">version</span></code>. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">driver</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">usePrecompiled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia-gpu-driver</span><span class="w"></span>
<span class="w">    </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">quay.io/nvidia-gpu-driver-example</span><span class="w"></span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">525.105.17</span><span class="w"></span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="using-the-cli">
<h3>Using the CLI<a class="headerlink" href="#using-the-cli" title="Permalink to this headline">#</a></h3>
<ol class="arabic">
<li><p>Create a template for the <code class="docutils literal notranslate"><span class="pre">ClusterPolicy</span></code> resource. Replace the NVIDIA GPU operator version with your value:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc get csv -n nvidia-gpu-operator gpu-operator-certified.v23.6.1 -ojsonpath<span class="o">={</span>.metadata.annotations.alm-examples<span class="o">}</span> <span class="p">|</span> jq <span class="s1">&#39;.[0]&#39;</span> &gt; clusterpolicy.json
</pre></div>
</div>
</li>
<li><p>Modify the <code class="docutils literal notranslate"><span class="pre">clusterpolicy.json</span></code> file to specify values for <code class="docutils literal notranslate"><span class="pre">driver.usePrecompiled</span></code>, <code class="docutils literal notranslate"><span class="pre">driver.repository</span></code>, <code class="docutils literal notranslate"><span class="pre">driver.image</span></code> and <code class="docutils literal notranslate"><span class="pre">driver.version</span></code>. For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;driver&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;usePrecompiled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;repository&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;quay.io/nvidia-gpu-driver-example&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;image&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;nvidia-gpu-driver&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;525.105.17&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">ClusterPolicy</span></code> resource from the modified <code class="docutils literal notranslate"><span class="pre">clusterpolicy.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc apply -f clusterpolicy.json
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">clusterpolicy.nvidia.com/gpu-cluster-policy created</span>
</pre></div>
</div>
</li>
<li><p>Confirm that the driver container pods are running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc get pods -l <span class="nv">app</span><span class="o">=</span>nvidia-driver-daemonset -n nvidia-gpu-operator
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">NAME                                                            READY   STATUS    RESTARTS   AGE</span>
<span class="go">nvidia-driver-daemonset-4.18.0-372.51.1.el8_6-rhcos4.12-mlpd4   1/1     Running   0          44s</span>
</pre></div>
</div>
<p>Ensure that the pod names include a Linux kernel version number like <code class="docutils literal notranslate"><span class="pre">4.18.0-372.51.1.el8_6</span></code>.</p>
</li>
</ol>
</section>
</section>
<section id="disabling-support-for-precompiled-driver-containers">
<h2>Disabling Support for Precompiled Driver Containers<a class="headerlink" href="#disabling-support-for-precompiled-driver-containers" title="Permalink to this headline">#</a></h2>
<p>Perform the following steps to disable support for precompiled driver containers.</p>
<ol class="arabic">
<li><p>Disable precompiled driver support by modifying the cluster policy:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc patch clusterpolicy/gpu-cluster-policy --type<span class="o">=</span><span class="s1">&#39;json&#39;</span> <span class="se">\</span>
-p<span class="o">=</span><span class="s1">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/driver/usePrecompiled&quot;, &quot;value&quot;:false},{&quot;op&quot;: &quot;remove&quot;, &quot;path&quot;: &quot;/spec/driver/version&quot;},{&quot;op&quot;: &quot;remove&quot;, &quot;path&quot;: &quot;/spec/driver/image&quot;},{&quot;op&quot;: &quot;remove&quot;, &quot;path&quot;: &quot;/spec/driver/repository&quot;}]&#39;</span>
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">clusterpolicy.nvidia.com/gpu-cluster-policy patched</span>
</pre></div>
</div>
</li>
<li><p>Confirm that the conventional driver container pods are running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc get pods -l openshift.driver-toolkit<span class="o">=</span><span class="nb">true</span> -n nvidia-gpu-operator
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">NAME                                                  READY   STATUS    RESTARTS   AGE</span>
<span class="go">nvidia-driver-daemonset-412.86.202303241612-0-f7v4t   2/2     Running   0          4m20s</span>
</pre></div>
</div>
<p>Ensure that the pod names do not include a Linux kernel semantic version number.</p>
</li>
</ol>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="openshift-virtualization.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">NVIDIA GPU Operator with OpenShift Virtualization</p>
      </div>
    </a>
    <a class="right-next"
       href="troubleshooting-gpu-ocp.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Troubleshooting</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-precompiled-driver-containers">About Precompiled Driver Containers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-and-restrictions">Limitations and Restrictions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-precompiled-driver-image">Building a Precompiled Driver Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#enabling-precompiled-driver-container-support">Enabling Precompiled Driver Container Support</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-web-console">Using the Web Console</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-yaml-file">Using the YAML File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-cli">Using the CLI</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#disabling-support-for-precompiled-driver-containers">Disabling Support for Precompiled Driver Containers</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">

<div class="footer-links">
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/">Privacy Policy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/">Manage My Privacy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/preferences/start/">Do Not Sell or Share My Data</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/">Terms of Service</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/accessibility/">Accessibility</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/company-policies/">Corporate Policies</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/product-security/">Product Security</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/contact/">Contact</a>
  
  
  
</div>
</div>
      
        <div class="footer-item">



  <p class="copyright">
    
      Copyright © 2020-2025, NVIDIA Corporation.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
</div>

  </footer>


  </body>
</html>